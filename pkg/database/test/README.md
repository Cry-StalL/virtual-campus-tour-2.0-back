# 数据库测试文档

## 测试环境要求

1. MySQL 数据库服务已启动
2. 测试数据库 `virtual_campus_tour_test` 已创建
3. 数据库用户具有适当的权限



## 测试用例说明

### 1. 数据库连接初始化测试

测试内容：
- 验证数据库连接配置是否正确
- 验证数据库连接是否成功建立
- 验证全局DB实例是否正确创建
- 验证数据库连接是否可用

测试步骤：
1. 使用测试配置初始化数据库连接
2. 验证初始化过程是否成功
3. 验证全局DB实例是否创建
4. 执行Ping测试验证连接可用性

### 2. 数据库连接关闭测试

测试内容：
- 验证数据库连接是否正确关闭
- 验证关闭过程是否产生错误

测试步骤：
1. 调用关闭数据库连接方法
2. 验证关闭过程是否成功

## 运行测试

在项目根目录下执行以下命令运行测试：

```bash
# 运行所有测试
go test ./pkg/database/test/...

# 运行特定测试
go test ./pkg/database/test/... -run TestDatabaseConnection

# 显示详细测试输出
go test -v ./pkg/database/test/...
```

## 测试注意事项

1. 测试前确保测试数据库已创建
2. 测试数据库配置应与实际环境匹配
3. 测试完成后会自动关闭数据库连接
4. 建议在测试环境中运行，避免影响生产数据库

## 常见问题

1. 连接失败
   - 检查数据库服务是否运行
   - 验证数据库配置是否正确
   - 确认数据库用户权限

2. 测试超时
   - 检查数据库连接池配置
   - 验证网络连接状态

3. 权限问题
   - 确保测试用户具有足够权限
   - 检查数据库访问控制设置 